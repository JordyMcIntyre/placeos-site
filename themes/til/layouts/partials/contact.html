<form
  action="https://submit.formspark.io/NNJrw6i1X"
  method="POST"
  class="space-y-4 snap-none scroll-target"
  id="contact"
>
  <!-- Hidden tags -->
  <input type="hidden" name="tags" value="4024487,3336663"> <section></section>

  <!-- Standard fields -->
  <div>
    <label for="firstName" class="block">First name</label>
    <input id="firstName" name="FIRSTNAME" require/>
  </div>
  <div>
    <label for="lastName" class="block">Last name</lab sel>
    <input id="lastName" name="LASTNAME" required/>
  </div>
  <div>
    <label for="email" class="block">Email</label>
    <input id="email" name="email" type="email" required/>
  </div>
  <div>
    <label for="company" class="block">Company</label>
    <input id="company" name="COMPANY" value="{{ .Site.Params.defaultCompany }}"/>
  </div>
  <div>
    <label for="jobTitle" class="block">Job title</label>
    <input id="jobTitle" name="JOBTITLE"/>
  </div>
  <div>
    <label for="country" class="block">Country</label>
    <input id="country" name="COUNTRY" value="Australia"/>
  </div>

  <!-- Product: hidden on product pages, dropdown elsewhere -->
  {{ if .Params.product }}
    <input type="hidden" name="PRODUCT" value="{{ .Params.product }}"/>
  {{ else }}
    <div>
      <label for="product" class="block">Product</label>
      <select id="product" name="PRODUCT" >
        <option value="">— select —</option>
        <option>WorkMate</option>
        <option>StageHand</option>
        <option>LensPath</option>
        <option>BackOffice</option>
        <option>Energy reduction</option>
        <option>Desk booking</option>
        <option>Room booking</option>
        <option>Visitor management</option>
        <option>Occupancy monitoring</option>
        <option>VirtualCare</option>
      </select>
    </div>
  {{ end }}

  <!-- Metrics fields -->
  <div class="grid grid-cols-2 gap-4">
    <div>
      <label for="desks">Desks</label>
      <input id="desks" name="DESKS" type="number" min="0" />
    </div>
    <div>
      <label for="rooms">Rooms</label>
      <input id="rooms" name="ROOMS" type="number" min="0" />
    </div>
    <div>
      <label for="floors">Floors</label>
      <input id="floors" name="FLOORS" type="number" min="0" />
    </div>
    <div>
      <label for="buildings">Buildings</label>
      <input id="buildings" name="BUILDINGS" type="number" min="0" />
    </div>
  </div>

  <div>
    <label for="subject" class="block">Subject</label>
    <input id="subject" name="SUBJECT" />
  </div>
  <div>
    <label for="message" class="block">Message</label>
    <textarea id="message" name="MESSAGE" rows="4" ></textarea>
  </div>

  <button type="submit" class="btn-light">
    {{ partial "svg/paper-plane.html" . }} Send message
  </button>
</form>

<!-- thank-you message, hidden by default -->
<div id="contactThankYou" style="display:none; margin-top:1.5rem;">
  <h2>Thank you!</h2>
  <p>We appreciate your message and will get back to you within 24 hours.</p>
</div>

<script>
  (function(){
    function initForm(formId, thankYouId){
      const form = document.getElementById(formId);
      const thankYou = document.getElementById(thankYouId);
      if (!form || !thankYou) return;

      form.addEventListener('submit', function(e) {
        const submitButton = this.querySelector('button[type="submit"]');
        if (submitButton) {
          submitButton.textContent = 'Sending...';
          submitButton.disabled = true;
        }
        
        // Create iframe dynamically for this submission
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.name = 'dynamicFrame_' + Date.now();
        document.body.appendChild(iframe);
        
        // Set form target to this new iframe
        this.target = iframe.name;
        
        // Listen for iframe load (when form submission completes)
        iframe.addEventListener('load', function() {
          // Small delay to ensure submission processed
          setTimeout(() => {
            form.style.display = 'none';
            thankYou.style.display = 'block';
            // Clean up iframe
            document.body.removeChild(iframe);
          }, 500);
        }, { once: true });
        
        // Don't prevent default - let form submit naturally
      });
    }

    document.addEventListener('DOMContentLoaded', ()=> {
      initForm('contact', 'contactThankYou');
    });
  })();
</script>
